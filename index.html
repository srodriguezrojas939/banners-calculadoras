<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Calculadora Icon Designer</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        :root {
            --bg-calc: #f0f0f0;
            --border-color: #d1d1d1;
            --screen-bg: #ffffff;
            --button-area-bg: #e5e5e5;
            --btn-black: #1a1a1a;
        }

        body {
            background: #fafafa;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px;
        }

        /* Contenedor Cuadrado para Exportación */
        #export-container {
            width: 500px;
            height: 500px;
            background: white; /* Puedes cambiar a transparent si prefieres */
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px dashed #ccc;
        }

        /* Estética de la Calculadora */
        .calculator {
            width: 340px;
            background: var(--bg-calc);
            border: 3px solid var(--border-color);
            border-radius: 50px; /* Muy redondeado */
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Pantalla de la Calculadora */
        .screen {
            background: var(--screen-bg);
            border: 2px solid var(--border-color);
            border-radius: 25px;
            height: 120px; /* Pantalla más grande */
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            overflow: hidden;
        }

        #latex-render {
            font-size: 1.8rem;
            color: #222;
        }

        /* Área de botones (Gris más oscuro) */
        .pad {
            background: var(--button-area-bg);
            border: 2px solid #d8d8d8;
            border-radius: 30px;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        /* Botones Estilo "Squircle" */
        .btn {
            background: var(--btn-black);
            width: 65px;
            height: 65px;
            border-radius: 20px; /* Redondeado medio cuadrado */
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
        }

        /* Botón Igual (Largo) */
        .btn-equal {
            grid-column: 3;
            grid-row: 1 / span 2;
            height: 100%;
            width: 65px;
            border-radius: 20px;
        }

        /* Controles de usuario */
        .ui-controls {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 400px;
        }

        input {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        .btn-download {
            background: #000;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }

        .btn-download:hover { background: #333; }
    </style>
</head>
<body>

    <div id="export-container">
        <div class="calculator">
            <div class="screen">
                <div id="latex-render"></div>
            </div>
            
            <div class="pad">
                <div class="btn">+</div>
                <div class="btn">-</div>
                <div class="btn btn-equal">=</div>
                <div class="btn">×</div>
                <div class="btn">÷</div>
            </div>
        </div>
    </div>

    <div class="ui-controls">
        <label>Escribe tu fórmula (LaTeX):</label>
        <input type="text" id="latex-input" placeholder="\frac{a}{b} + \sqrt{x}" value="\int_{a}^{b} x^2 dx">
        <button class="btn-download" onclick="downloadImage()">Descargar PNG de alta calidad</button>
    </div>

    <script>
        const input = document.getElementById('latex-input');
        const output = document.getElementById('latex-render');

        // Función para renderizar LaTeX en tiempo real
        function updateMath() {
            try {
                katex.render(input.value, output, {
                    throwOnError: false,
                    displayMode: true
                });
            } catch (e) {
                console.error(e);
            }
        }

        // Escuchar cambios en el input
        input.addEventListener('input', updateMath);

        // Inicializar
        updateMath();

        // Función para descargar la imagen
        function downloadImage() {
            const container = document.getElementById('export-container');
            
            // Usamos una escala alta (x3) para que el PNG sea de alta resolución
            html2canvas(container, {
                backgroundColor: null,
                scale: 3, 
                logging: false,
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'icon-calculadora.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        }
    </script>
</body>
</html>
